<!-- 
1. Create a set of object types that describe a series of related objects that may share behavior and/or attributes. 
Code the example and another set of classes different from the example. Add properties/methods as needed. 
    Example:
    Shape { pEdges, fnDisplay }
    Quadrilateral is Shape { fnArea, fnPerimeter} 
    Square is Quadrilateral { }
    Triangle is Shape {fnArea, fnPerimeter}
    Use of inheritance, prototype, and function overwriting.
Estimated Time: 4 h.
-->

<!DOCTYPE html>
<html>
  <head>
    <title>Chapter 05, ex 01, Bank</title>
    <script type="text/javascript" src="../../scripts/assert.js"></script>
    <link href="../../styles/assert.css" rel="stylesheet" type="text/css">
  </head>
  <body>
    <script type="text/javascript">

      /// ****************************
      // Point
      /// ****************************
      function Point(x, y){

        this.x = x;

        this.y = y;

      }

      function Shape(){

        this.pEdges = [];

        this.pEdges = Array.prototype.slice.call(arguments, 0);

      }  
      Shape.prototype.fnDisplay = function(){
        console.log("");
        console.log("Displaying shape: "); 
        for (var i = 0; i < this.pEdges.length; i++) {
          console.log("point[" + i + "]: x = " 
            + this.pEdges[i].x + ", y = " + this.pEdges[i].y);
        };
      };
      Shape.prototype.fnDistance = function(){

        function distance2D(x1, y1, x2, y2){
          return Math.sqrt(
            Math.pow((x1 - x2), 2) + 
            Math.pow((y1 -y2), 2));              
        }
        
        function distance3D(x1, y1, z1, x2, y2, z2){
          return Math.sqrt(
            Math.pow((x1 - x2), 2) + 
            Math.pow((y1 -y2), 2) +
            Math.pow(z1 - z2, 2));          
        }        

        if (arguments.length == 2){
          var p1 = arguments[0];
          var p2 = arguments[1];
          if (p1.length != p2.length){
            console.log("Different sized arrays");
            return undefined;            
          }
          if(p1.length == 2)
          {
            distance2D(p1[0], p1[1], p2[0], p2[1]);
          }
          else if(p1.length == 3){
            distance3D(p1[0], p1[1], p1[2], p2[0], p2[1], p2[2]);
          }
          else{
            console.log("Wrong number of parameters");
          }
        }
        else if (arguments.length == 4)
        {
            return distance2D(arguments[0], arguments[1], 
              arguments[2], arguments[3]);
        }
        else if (arguments.length == 6){
            return distance3D(arguments[0], arguments[1], arguments[2], 
              arguments[3], arguments[4], arguments[5]);
        }
        else{
          console.log("Wrong number of parameters");
          return undefined;
        }
      };


      /// ****************************
      // Quadrilateral
      /// ****************************
      function Quadrilateral(e1, e2, e3, e4){

        Shape.call(this, e1, e2, e3, e4); 

      }
      Quadrilateral.prototype = Object.create(Shape.prototype);
      Quadrilateral.prototype.constructor = Quadrilateral;
      Quadrilateral.prototype.fnArea = function(){
        // non supported operation
        return false;   
      }
      Quadrilateral.prototype.fnPerimeter = function(){
        if (this.pEdges.length < 2){
          return 0;
        }
        var perimeter = this.fnDistance(
          this.pEdges[0].x, 
          this.pEdges[0].y,
          this.pEdges[this.pEdges.length - 1].x,
          this.pEdges[this.pEdges.length - 1].y
        );
        for (var i = 1; i < this.pEdges.length; i++) {
          perimeter += this.fnDistance(
            this.pEdges[i].x, this.pEdges[i].y,
            this.pEdges[i - 1].x, this.pEdges[i - 1].y
          );
        };
        return perimeter;
      }


      /// ****************************
      // Square
      /// ****************************
      function Square(e1, e2, e3, e4){        

        Quadrilateral.call(this, e1, e2, e3, e4);

        if (!equalDistances.call(this, this.pEdges)){
          //throw error
          throw "Not a Square";         
        }        

        function equalDistances(args){
          var side = this.fnDistance(
            args[0].x, 
            args[0].y,
            args[args.length - 1].x,
            args[args.length - 1].y);
          for (var i = 1; i < args.length; i++) {
            if (side != this.fnDistance(
              args[i].x, args[i].y,
              args[i - 1].x, args[i - 1].y
            )){
              return false;
            }
          };
          return true;
        }

      }
      Square.prototype = Object.create(Quadrilateral.prototype);
      Square.prototype.constructor = Square;
      Square.prototype.fnArea = function(){
        var sideLong = this.fnDistance(
          this.pEdges[0].x, this.pEdges[0].y,
          this.pEdges[1].x, this.pEdges[1].y);        
        return sideLong * sideLong;
      }
      Square.prototype.fnPerimeter = function(){
        var sideLong = this.fnDistance(
          this.pEdges[0].x, this.pEdges[0].y,
          this.pEdges[1].x, this.pEdges[1].y);        
        return 4 * sideLong;        
      }

      /// ****************************
      // Triangle
      /// ****************************
      function Triangle(e1, e2, e3){

        Shape.call(this, e1, e2, e3);

      }
      Triangle.prototype = Object.create(Shape.prototype);
      Triangle.prototype.constructor = Triangle;
      Triangle.prototype.fnArea = function(){
        // non supported operation
        return false;   
      }
      Triangle.prototype.fnPerimeter = function(){
        if (this.pEdges.length < 2){
          return 0;
        }
        var perimeter = this.fnDistance(
          this.pEdges[0].x, 
          this.pEdges[0].y,
          this.pEdges[this.pEdges.length - 1].x,
          this.pEdges[this.pEdges.length - 1].y);
        for (var i = 1; i < this.pEdges.length; i++) {
          perimeter += this.fnDistance(
            this.pEdges[i].x, this.pEdges[i].y,
            this.pEdges[i - 1].x, this.pEdges[i - 1].y
          );
        };
        return perimeter;
      }



      // Unit Tests
      s1 = new Shape(
        new Point(-2, 1),
        new Point(-2, 5),        
        new Point(1, 5),
        new Point(1, 1)
      );
      s1.fnDisplay();

      q1 = new Quadrilateral(
        new Point(-2, 1),
        new Point(-2, 5),        
        new Point(1, 5),
        new Point(1, 1)
      );
      q1.fnDisplay();
      console.log("q1 perimeter: " + q1.fnPerimeter());

      q2 = new Quadrilateral(
        new Point(-3, 1),
        new Point(-1, 5),        
        new Point(1, 5),
        new Point(2, 1)
      );      
      q2.fnDisplay();
      console.log("q2 perimeter: " + q2.fnPerimeter());

      c1 = new Square(
        new Point(-2, 1),
        new Point(-2, 4),        
        new Point(1, 4),
        new Point(1, 1)
      );
      c1.fnDisplay();    
      console.log("c1 perimeter: " + c1.fnPerimeter());
      console.log("c1 area: " + c1.fnArea());

      t1 = new Triangle(
        new Point(-2, 1),
        new Point(1, 5),
        new Point(1, 1)
      );
      t1.fnDisplay();
      console.log("t1 perimeter: " + t1.fnPerimeter());      

      c2 = new Square(
        new Point(-1, 1),
        new Point(-2, 4),        
        new Point(1, 4),
        new Point(1, 1)
      );      
      if (c2)
        console.log("c2 is: " + c2);      
      else
        console.log("wrong c2");

    </script>
  </body>
</html>
