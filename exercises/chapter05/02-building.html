<!-- 
2. Implement the following:
   1. A large building has many people and pieces of equipment. A new tech-support employee has been hired to help out solve usersâ€™ problems 
    and fix broken equipment. The new employee is still unfamiliar with the layout but is doing his best to keep track of where everyone and 
    everything is.
      1. Implement a structure that represents the building.
         1. Must contain data types representing equipment and users.
      1. Equipment can be associated with rooms or specific people
      2. Each piece of equipment and person is associated with a specific floor and room.
      3. The new tech-support employee must be able to find users and equipment as quickly as possible.
        Use of memoization and implementation of a simple searching algorithm.
        Estimated Time: 4 hr.
-->

<!DOCTYPE html>
<html>
  <head>
    <title>Chapter 05, ex 02, Building</title>
    <script type="text/javascript" src="../../scripts/assert.js"></script>
    <script type="text/javascript" src="User.js"></script>
    <script type="text/javascript" src="Equipment.js"></script>
    <script type="text/javascript" src="Room.js"></script>
    <script type="text/javascript" src="Floor.js"></script>

    <link href="../../styles/assert.css" rel="stylesheet" type="text/css">
  </head>
  <body>
    <script type="text/javascript">

      function Building(){

        var floors = [];

        return {

          addFloors : function(){
            for (var i = 0; i < arguments.length; i++) {
              floors.push(arguments[i]);
            };
          },

          // main searching algorithm
          findEquipment : function(id){

            this.cache = this.cache || {};
            if(this.cache[id] != null){
              console.log("Found at cache: Equipment number " +  this.cache[id]);
              return this.cache[id];
            }

            for (var i = 0; i < floors.length; i++) {
              console.log("Floor number " + i);              
              var eq = null;
              if (eq = floors[i].getEquipmentById(id)){
                return this.cache[id] = eq;
              }
            };
            return null;
          }

        }

      }



      // UNIT TESTS

      var building = Building();
      building.addFloors(
        Floor(
          Room(), 
          Room().addEquipment(
            Equipment()
          // ).addUsers("Joe", "Jill", "Jack", "Alice")
          ).addUsers(
            User("Joe"), 
            User("Jill").setEquipment(Equipment()),
            User("Jack").setEquipment(Equipment()),
            User("Alice")
          )
        ), 
        Floor(
        ), 
        Floor(
          Room(), 
          Room(), 
          Room().addEquipment(
            Equipment(), Equipment()
          )
        ), 
        Floor(
          Room()
        )
      );

      assert(building.findEquipment(6) === null, "building.findEquipment(5) === null");
      console.log("");
      assert(building.findEquipment(1) !== null, "building.findEquipment(1) !== null");
      console.log("");
      assert(building.findEquipment(3) !== null, "building.findEquipment(3) !== null");
      console.log("");
      assert(building.findEquipment(5).fix() !== null, "building.findEquipment(5).fix() !== null");
      console.log("");
      assert(building.findEquipment(2).fix() !== null, "building.findEquipment(2).fix() !== null");
      console.log("");      
      assert(building.findEquipment(1).fix() !== null, "building.findEquipment(1).fix() !== null");
      console.log("");
      assert(building.findEquipment(5).fix() !== null, "building.findEquipment(5).fix() !== null");
      console.log("");
      assert(building.findEquipment(2).fix() !== null, "building.findEquipment(2).fix() !== null");
      console.log("");

      console.log(building);
 
    </script>
  </body>
</html>
